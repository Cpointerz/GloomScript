## GloomScript Development

#### Current Target

- [x] ByteCode generation
- [x] ByteCode interpret
- [ ] async runtime and API support
- [ ] better interpretation entrance

#### Code Organization

- `/gloom` : `GloomScript` files which have a suffix of `.gs` . If project is stable, all the files in this directory should be executable to interpreter of GloomScript.

- `/src`
    - `/frontend` : laxer parser and analysis that implemented manually
    - `/bytecode` : ByteCode presentation and generation
    - `/vm` : program virtual machine or called ByteCode interpreter
    - `/obj` : some Rust type about object in GloomScript
    - `/builtin` : Built-in type in GloomScript that implemented in Rust such as String and Array
- `/doc` : Documents

#### Overview and Internal

**Laxer** : source → `Vec<u8>` → `Vec<Token>`, type Token defined in `/src/frontend/token.rs`, laxer defined in `/src/frontend/tokenize.rs`.

**Parse** : `Vec<Token>` → `ParsedFile` , you could find the `ParsedFile` in `src/frontend/script.rs` , which contains class interface enum direct-defined-function and script body of *a single script file*. the parser defined in `/src/frontend/parse.rs`, And the type that used to describe the abstract syntax tree in a function is `Expression` and `Statement` , which defined in `/src/frontend/ast.rs`.

**Analysis** : `ParsedFile` → `GloomStatus`, you could find the `GloomStatus` in `src/frontend/status.rs`, which contains class interface enum direct-defined-function and script body of *whole script files*. So the laxer and parse will happened for more than once, but analysis will happened only once. The type and syntax mistakes will be checked during analysis period. The analysis is most complex part of whole project. Only the file `src/frontend/analysis.rs` have more than 1800 lines. So I don't recommend you to modify Analyzer.

**ByteCode generation** : replace all the AST with generated ByteCode. ByteCode defined in `src/bytecode/code.rs`, the Code Generator defined in `src/bytecode/gen.rs` . The ByteCode is designed by myself.

**ByteCode interpretation** : The virtual machine defined in `src/vm/machine`. This VM is a operand-stack VM. If you know about the bytecode and types, this module is easy to understand.

#### Environment 

Rust edition : 2018

#### Code style

`rustfmt` is recommended.

You'd better comment more in hard-understand code. Now this project have 8000 lines of code with 400 line of comments. And most of them write in both Chinese and English.

#### Profiles

Have not yet. I try to construct a high-performance application, but in fact I have no a lot experience about profiling. Welcome you to construct it profiling layout.

